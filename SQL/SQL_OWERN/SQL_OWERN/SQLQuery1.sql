use Test;

--1. Create 'COUNTRY' table
CREATE TABLE COUNTRY(
CountryId INT IDENTITY PRIMARY KEY, --auto-increment primary key
CountryName VARCHAR(30),
Continent VARCHAR(10),
Currency VARCHAR(3)
);

--2. Create 'DEPARTMENT' table
CREATE TABLE DEPARTMENT(
DepartmentId INT PRIMARY KEY,
DeptName VARCHAR(10),
CountryId INT FOREIGN KEY REFERENCES dbo.COUNTRY(CountryId),
);

--3. Create 'EMPLOYEE' table
CREATE TABLE EMPLOYEE(
EmpID INT PRIMARY KEY,
EmpName VARCHAR(20) NOT NULL,
DeptId INT FOREIGN KEY REFERENCES dbo.DEPARTMENT (DepartmentId) NULL,
PhoneNo bigInt,
);

--4. Create 'FOLDER' table
CREATE TABLE FOLDER(
FolderId INT NOT NULL,
EmpId INT REFERENCES EMPLOYEE(EmpId),
AccessType VARCHAR(5) NULL
);


INSERT INTO COUNTRY VALUES('Germany', 'EUROPE', 'EUR');
INSERT INTO COUNTRY VALUES('London', 'UK', 'GBP');
INSERT INTO COUNTRY VALUES('India', 'ASIA', 'INR');
INSERT INTO COUNTRY VALUES('California', 'USA', 'USD');

INSERT INTO DEPARTMENT VALUES (29, 'R&D', 2);
INSERT INTO DEPARTMENT VALUES (17, 'HR', 1);
INSERT INTO DEPARTMENT VALUES (9, 'Finance', 3);
INSERT INTO DEPARTMENT VALUES (4, 'Product', 4);

INSERT INTO EMPLOYEE VALUES (1, 'Zuckerberg', NULL,9962075982);
INSERT INTO EMPLOYEE VALUES (3, 'Jobs', 17,9962075982);
INSERT INTO EMPLOYEE VALUES (2, 'Turing', 9,9962075982);
INSERT INTO EMPLOYEE VALUES (4, 'Musk', 29,9962075982);
INSERT INTO EMPLOYEE VALUES (5, 'Tesla', 9,9962075982);

INSERT INTO FOLDER VALUES(1, 1, 'Read');
INSERT INTO FOLDER VALUES(1, 1, 'Write');
INSERT INTO FOLDER VALUES(1, 4, 'Read');
INSERT INTO FOLDER VALUES(1, 3, 'Read');
INSERT INTO FOLDER VALUES(2, 4, 'Read');
INSERT INTO FOLDER VALUES(2, 5, 'Write');
INSERT INTO FOLDER VALUES(3, null, null);

SELECT * FROM EMPLOYEE E INNER JOIN DEPARTMENT D ON E.DeptId = D.DepartmentId ; 
SELECT * FROM EMPLOYEE E FULL OUTER JOIN DEPARTMENT D ON E.DeptId = D.DepartmentId ; 
SELECT * FROM EMPLOYEE E LEFT OUTER JOIN DEPARTMENT D ON E.DeptId = D.DepartmentId ; 
SELECT * FROM EMPLOYEE E RIGHT OUTER JOIN DEPARTMENT D ON E.DeptId = D.DepartmentId ; 

-- BOTH ARE SAME OUTER DOES N'T MATTER

SELECT * FROM EMPLOYEE E INNER JOIN DEPARTMENT D ON E.DeptId = D.DepartmentId ; 
SELECT * FROM EMPLOYEE E FULL JOIN DEPARTMENT D ON E.DeptId = D.DepartmentId ; 
SELECT * FROM EMPLOYEE E LEFT JOIN DEPARTMENT D ON E.DeptId = D.DepartmentId ; 
SELECT * FROM EMPLOYEE E RIGHT JOIN DEPARTMENT D ON E.DeptId = D.DepartmentId ;
SELECT * FROM DEPARTMENT;
SELECT * FROM EMPLOYEE E CROSS JOIN DEPARTMENT D  ;

--4 Create a select statement that outputs like the following <customer name> can be reached at x<last four digit of phone>

SELECT CONCAT(EmpName,' CANT BE REACHED AT X',right(PhoneNo,4)) FROM EMPLOYEE;
SELECT EmpName + ' CANT BE REACHED AT X' + RIGHT(CAST(PhoneNo AS VARCHAR), 4) 
FROM EMPLOYEE;

--drop table DEPARTMENT;,
--drop table COUNTRY;
--drop table FOLDER;
--drop table EMPLOYEE;